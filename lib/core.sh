#!/bin/bash

print_help() {
    cat <<EOF | sed 's/\\033/\x1b/g'
Command Tips v$VERSION

Использование
  tips [ФЛАГ] [АРГУМЕНТ]     Управление персональными командами-подсказками

Добавление и редактирование
  -a, --add '<команда>' '[комментарий]'   Добавить подсказку
  -y, --last-cmd '[комментарий]'          Использовать последнюю команду из истории
  -t, --tags <номер> '<теги>'             Добавить теги к записи (через запятую)
  --remove-tags <номер> '<теги>'          Удалить теги у записи

Поиск и фильтрация
  -l, --list                              Показать все подсказки с номерами
  -s, --search '<запрос>'                 Поиск по командам, комментариям и тегам
  --all-tags '<теги>'                     Фильтр по всем указанным тегам (AND-логика)
  --any-tags '<теги>'                     Фильтр по любому из тегов (OR-логика)

Управление базой
  -e, --edit <номер>                      Редактировать команду и комментарий
  -d, --delete <номер>                    Удалить подсказку
  --clear                                 Полная очистка базы
  --backup <путь>                         Создать резервную копию базы

Интеграция
  -i, --insert <номер>                    Вставить команду в текущий терминал
  -c, --copy <номер>                      Скопировать команду в буфер обмена

Информация и статистика
  \033[32m --count                                 Общее количество записей \033[0m
  --info <номер>                          Подробная информация о записи
  \033[32m -v, --version                           Версия программы \033[0m
  \033[32m -h, --help                              Эта справка \033[0m 

Системная информация
  Файл данных: $DB_FILE
  Всего записей: $(count_tips)

Примеры:
1. Добавление с тегами:
   tips --add 'tar -xzvf file.tar.gz' 'Распаковка архивов' --tags архивы,gzip

2. Поиск по нескольким тегам:
   tips --search 'архивы' --tags системные,backup

3. Копирование команды в буфер:
   tips --copy 15 || tips --insert 15 | xclip -selection clipboard

4. Работа с историей:
   sudo apt update && tips --last-cmd 'Обновление пакетов' --tags система

5. Расширенное редактирование:
   tips --add-tags 7 сети,nginx --remove-tags 7 временные
EOF
}

print_version() {
    print_msg y "Command Tips v$VERSION"
}